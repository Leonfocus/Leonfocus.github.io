<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Leon's Blog, ">


    <!-- FAVICON -->
    <link rel="apple-touch-icon" sizes="57x57" href="#">
    <link rel="apple-touch-icon" sizes="114x114" href="#">
    <link rel="apple-touch-icon" sizes="72x72" href="#">
    <link rel="apple-touch-icon" sizes="144x144" href="#">
    <link rel="apple-touch-icon" sizes="60x60" href="#">
    <link rel="apple-touch-icon" sizes="120x120" href="#">
    <link rel="apple-touch-icon" sizes="76x76" href="#">
    <link rel="apple-touch-icon" sizes="152x152" href="#">
    <link rel="apple-touch-icon" sizes="180x180" href="#">
    <link rel="icon" type="image/png" href="#" sizes="192x192">
    <link rel="icon" type="image/png" href="#" sizes="160x160">
    <link rel="icon" type="image/png" href="#" sizes="96x96">
    <link rel="icon" type="image/png" href="#" sizes="16x16">
    <link rel="icon" type="image/png" href="#" sizes="32x32">
    
    
    
   
    
    
    
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">    
    
        <link rel="alternate"  href="http://leonfocus.github.io/feeds/atom.xml" type="application/atom+xml" title="Leon's Blog Full Atom Feed"/>
        <link rel="alternate" href="http://leonfocus.github.io/feeds/rss.xml" type="application/rss+xml" title="Leon's Blog Full RSS Feed"/>

        <title>Leon's Blog - Newton插值法</title>

    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
    <!--<![endif]-->
    <link rel="stylesheet" href="http://leonfocus.github.io/theme/css/styles.css">
    <link rel="stylesheet" href="http://leonfocus.github.io/theme/css/pygments.css">
    <!-- <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'> -->
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,500" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet' type='text/css'>
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <style>  
        p#back-to-top {  
            position: fixed;  
            bottom: 50px;  
            right: 50px;  
        }  
          
        p#back-to-top a {  
            text-align: center;  
            text-decoration: none;  
            color: #d1d1d1;  
            display: block;  
            width: 50px;    
            -moz-transition: color 1s;  
            -webkit-transition: color 1s;  
            -o-transition: color 1s;  
        }  
        p#back-to-top a:hover {  
            color: #979797;  
        }  
        p#back-to-top a span {  
            background: #d1d1d1 url(/theme/images/backtop.png) no-repeat center center;  
            border-radius: 6px;  
            display: block;  
            height: 50px;  
            width: 50px;  
            margin-bottom: 5px;    
            -moz-transition: background 1s;  
            -webkit-transition: background 1s;  
            -o-transition: background 1s;  
        }  
          
        #back-to-top a:hover span {  
            background: #979797 url(/theme/images/backtop.png) no-repeat center center;  
        }  
    </style>

    <script>  
    $(document).ready(function() {    
        $("#back-to-top").hide();  
        
        $(function() {  
            $(window).scroll(function() {  
                if ($(window).scrollTop() > 100) {  
                    $("#back-to-top").fadeIn(1500);  
                }  
                else {  
                    $("#back-to-top").fadeOut(1500);  
                }  
            });    
            $("#back-to-top").click(function() {  
                $('body,html').animate({  
                    scrollTop: 0  
                },  
                500);  
                return false;  
            });  
        });  
    });  
</script> 

    
</head>

<body id="top">


    <header id="header" class="pure-g">
        <div class="pure-u-1 pure-u-md-3-4">
             <div id="menu">
                 <div class="pure-menu pure-menu-open pure-menu-horizontal">
<ul>
        <li><a href="/">Home</a></li>
        <li><a href="/muse/">Muse</a></li>
        <li><a href="/practice/">Practice</a></li>
        <li><a href="/contact/">Contact</a></li>
</ul>                </div>
            </div>
        </div>

        <div class="pure-u-1 pure-u-md-1-4">
            <div id="social">
                <div class="pure-menu pure-menu-open pure-menu-horizontal">
<ul>
        <li><a href="#"><i class="fa fa-twitter"></i></a></li>
        <li><a href="https://github.com/Leonfocus"><i class="fa fa-github"></i></a></li>
        <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
        <li><a href="/feeds/atom.xml"><i class="fa fa-rss"></i></a></li>
</ul>                </div>
            </div>
        </div>
    </header>
       
    <p id="back-to-top"><a href="#top"><span></span></a></p>
    
    <div id="layout" class="pure-g">
        <section id="content" class="pure-u-1 pure-u-md-3-4">
            <div class="l-box">

    <header id="page-header">
        <h1>Newton插值法</h1>
            <div class="post-meta">
                    十二月 06, 2014
                </div>
                <div class="post-tags">
                    <ul>
                        <li>tags:</li>
                        <li><a href="/tag/numerical/">numerical</a></li>
                        <li><a href="/tag/python/">python</a></li>
                    </ul>
                </div>    
    </header>

    <section id="page">
        <p>&emsp;&emsp;Lagrange插值法通过选定一组形式对称的插值基函数来线性组合出插值多项式，但问题在于计算量比较大，且容易重复计算，这个问题可以通过逐次线性插值的方法予以解决，由递推关系逐步得到更高次的插值。Newton插值法的显著优势在于：既能得到递推式，又有明确的插值多项式——真是皆大欢喜！</p>
<p>&emsp;&emsp;首先我们知道n+1个节点的插值多项式次数不超过n，Newton插值多项式的构造形式如下：
<div class="math">$$N_n(x)=a_0+a_1(x-x_0)+a_2(x-x_0)(x-x_1)+\cdots+a_n(x-x_0)\cdots(x-x_{n-1})$$</div>
我们自然要问，这样构造的道理在哪？（我不会问“为啥我就想不出来这样构造呢？”） ^_^ 其实，上面的n+1个多项式是线性无关的，故而任何一个n次多项式都可以由之线性组合得到，也即可以作为插值基函数。另外，插值条件<span class="math">\(N_n(x_i)=y_i, i=0,1,2,\cdots,n\)</span> 可以求得系数<span class="math">\(a_i\)</span>，有
<div class="math">$$a_0=f(x_0), a_1=\frac{f(x_1)-f(x_0)}{x_1-x_0}, a_2=\cdots$$</div>
再往下待定系数<span class="math">\(a_i\)</span>的形式就比较复杂了，所以先引入<strong>差商</strong>的概念。</p>
<h2 id="_1">差商</h2>
<p>&emsp;&emsp;对于互异节点，<span class="math">\(f(x)\)</span>在点<span class="math">\(x_i,x_j\)</span>的一阶差商<div class="math">$$f[x_i,x_j]=\frac{f(x_i)-f(x_j)}{x_i-x_j}$$</div>
<span class="math">\(f(x)\)</span>在点<span class="math">\(x_i,x_j，x_k\)</span>的二阶差商（也就是差商的差商）<div class="math">$$f[x_i,x_j,x_k]=\frac{f[x_i,x_j]-f[x_j,x_k]}{x_i-x_k}$$</div>
以此类推，<span class="math">\(f(x)\)</span>在点<span class="math">\(x_0,x_1,\cdots,x_k\)</span>的k阶差商（即k-1阶差商的差商）
<div class="math">$$f[x_0,x_1,\cdots,x_k]=\frac{f[x_0,x_1,\cdots,x_{k-1}]-f[x_1,x_2,\cdots,x_k]}{x_0-x_k}$$</div>
差商的定义非常简单，其具有如下性质：</p>
<ol>
<li>k阶差商可由函数值<span class="math">\(f(x_0),f(x_1),\cdots,f(x_k)\)</span>线性组合表示，且<div class="math">$$f[x_0,x_1,\cdots,x_k]=\sum^k_{i=0}\frac{f(x_i)}{(x_i-x_0)\cdots(x_i-x_{i-1})(x_i-x_{i+1})\cdots(x_i-x_k)}$$</div>
</li>
<li>差商具有轮换对称性，即任意调换节点的次序，差商值不变，例如<span class="math">\(f[x_0,x_1,x_2]=f[x_1,x_0,x_2]=f[x_2,x_1,x_0]\)</span>.</li>
<li>如果$f(x)是x的n次多项式，则k阶差商是n-k次多项式，k&gt;n时差商为零.</li>
</ol>
<p>&emsp;&emsp;显而易见，差商也是用递推关系来定义的，我们可以用表格（差商表）来展示其计算过程：</p>
<p>&emsp;&emsp;<img alt="Newton interpolation" src="../images/newton.png" /></p>
<p>&emsp;&emsp;现在我们再继续讨论Newton插值公式，有了差商概念之后，我们将待定系数写成 <span class="math">\(a_k=f[x_0,x_1,\cdots,x_k]\)</span>, 也就是说Newton插值多项式的组合系数为差商形式。由此，<span class="math">\(f(x)\)</span>关于节点<span class="math">\(x_i\)</span>的n次Newton插值多项式写为
<div class="math">\begin{align*}
N_n(x) &amp;= f(x_0)+\sum^n_{k=1}f[x_0,x_1,\cdots,x_k]\prod^{k-1}_{j=0}(x-x_j)\\
         &amp;= f(x_0)+\sum^n_{k=1}f[x_0,x_1,\cdots,x_k]P_k(x)
\end{align*}</div>
由于插值多项式的唯一性，Newton法与Lagrange法插值多项式的余项（截断误差）相同，即
<div class="math">$$R_n(x)=f(x)-N_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}P_{n+1}(x)$$</div>
实际上，我们可以直接由差商定义得到<span class="math">\(f(x)\)</span>，只需将<span class="math">\(x\)</span>视为一个节点(<span class="math">\(x\ne x_i\)</span>)，则
<div class="math">\begin{align*}
f(x) &amp;= f(x_0)+f[x,x_0](x-x_0)\\
     &amp;= f(x_0)+(f[x_0,x_1]+f[x,x_0,x_1](x-x_1))(x-x_0)\\
     &amp;  \cdots \\
     &amp;= N_n(x)+f[x,x_0,x_1,\cdots,x_n]P_{n+1}(x)=N_n(x)+R_n(x)
\end{align*}</div>
故，又有<div class="math">$$R_n(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}P_{n+1}(x)=f[x,x_0,x_1,\cdots,x_n]P_{n+1}(x)$$</div>
另外，我们可以直接写出递推式
<div class="math">$$N_{n+1}(x)=N_n(x)+f[x_0,x_1,\cdots,x_{n+1}]P_{n+1}(x)$$</div>
一般可以将得到如下估计误差的使用公式 <span class="math">\(R_n(x)\approx f[x_0,x_1,\cdots,x_{n+1}]P_{n+1}(x)\)</span>.</p>
<p>&emsp;&emsp;实际上，Newton插值与逐次线性插值在节点逐步增加时，计算公式的每一步都是等价的。但是更一般地来说，Newton插值在计算多个<span class="math">\(x\)</span>点时需要重新计算的相对较少。</p>
<h2 id="_2">差分</h2>
<p>&emsp;&emsp;与差商密切相关的另一个概念是差分，它是指在等距节点上函数值的差，引进这一概念的目的是为了回答以下问题：“在某些特殊的情形是否可以简化Newton插值?”所谓等距节点，是指对给定的常数<span class="math">\(h\)</span>（称为步长），节点<span class="math">\(x_i=x_0+ih\)</span>, <span class="math">\(i=0,1,\cdots,n\)</span>，称<span class="math">\(\Delta f_i \equiv f(x_{i+1})-f(x_i)\)</span> 为<span class="math">\(f(x)\)</span>在<span class="math">\(x_i\)</span>处的一阶向前差分；<span class="math">\(\nabla f_i \equiv f(x_{i})-f(x_{i-1})\)</span> 为<span class="math">\(f(x)\)</span>在<span class="math">\(x_i\)</span>处的一阶向后差分。<span class="math">\(\Delta^2 f_i \equiv \Delta f(x_{i+1})-\Delta f(x_i)\)</span> 为<span class="math">\(f(x)\)</span>在<span class="math">\(x_i\)</span>处的二阶向前差分；<span class="math">\(\nabla^2 f_i \equiv \nabla f(x_{i})-\nabla f(x_{i-1})\)</span> 为<span class="math">\(f(x)\)</span>在<span class="math">\(x_i\)</span>处的二阶向后差分。依此类推，<div class="math">$$\Delta^m f_i \equiv \Delta^{m-1} f(x_{i+1})-\Delta^{m-1} f(x_i)$$</div> 为<span class="math">\(f(x)\)</span>在<span class="math">\(x_i\)</span>处的m阶向前差分；<div class="math">$$\nabla^m f_i \equiv \nabla^{m-1} f(x_{i})-\nabla^{m-1} f(x_{i-1})$$</div> 为<span class="math">\(f(x)\)</span>在<span class="math">\(x_i\)</span>处的m阶向后差分。可以看出，m阶向前差分是从<span class="math">\(f(x_i)\)</span>开始，上溯m个函数值到<span class="math">\(f(x_{i+m})\)</span>；而m阶向后差分是从<span class="math">\(f(x_i)\)</span>开始，下溯m个函数值到<span class="math">\(f(x_{i-m})\)</span>。我们得出（可以用数学归纳法证明，但从理解上比较直观）向前差分和向后差分有以下关系式：<span class="math">\(\Delta^m f_i = \nabla^m f_{i+m}\)</span>，例如：<span class="math">\(\Delta f_i = \nabla f_{i+1}\)</span>，<span class="math">\(\Delta^2 f_i = \nabla^2 f_{i+2}\)</span>。由此，我们给出如下差分表：</p>
<p>&emsp;&emsp;<img alt="Newton interpolation" src="../images/newton2.png" /></p>
<p>&emsp;&emsp;另一方面，我们已经指出“m阶向前差分是从<span class="math">\(f(x_i)\)</span>开始，上溯m个函数值到<span class="math">\(f(x_{i+m})\)</span>”，也就是说<span class="math">\(\Delta^m f_i\)</span>与<span class="math">\(f_i,f_{i+1},\cdots,f_{i+m}\)</span>这m+1个函数值相关，实际上通过归纳法可以得出差分与函数值有如下关系：<div class="math">$$\Delta^m f_i=C^0_m f_{i+m}+C^1_m f_{i+m-1}+\cdots+C^{m-1}_m f_{i+1}+C^m_m f_i, $$</div>系数为组合数，数值上与<span class="math">\((a-b)^m\)</span>的展开系数相同。</p>
<p>&emsp;&emsp;为了导出等距节点时差分插值公式，我们先讨论差分与差商的关系，然后直接带入Newton插值公式即可。节点距离h，有
<div class="math">$$f[x_i,x_{i+1}]=\frac{f_{i+1}-f_i}{x_{i+1}-x_i}=\frac{\Delta f_i}{h}=\frac{\nabla f_{i+1}}{h}$$</div>
<div class="math">$$f[x_i,x_{i+1}]=\frac{f[x_i,x_{i+1}]-f[x_{i+1},x_{i+2}]}{x_{i}-x_{i+2}}=\frac{\Delta f_i-\Delta f_{i+1}}{-2h^2}=\frac{\Delta^2 f_i}{2h^2}=\frac{\nabla^2 f_{i+2}}{2h^2}$$</div>
以此类推，
<div class="math">$$f[x_i,x_{i+1},\cdots,x_{i+m}]=\frac{\Delta^m f_i}{m!h^m}=\frac{\nabla^m f_{i+m}}{m!h^m}$$</div>
<div class="math">$$f[x_0,x_{1},\cdots,x_{k}]=\frac{\Delta^0 f_i}{k!h^k}=\frac{\nabla^k f_{k}}{k!h^k}$$</div>
</p>
<p>&emsp;&emsp;如果节点<span class="math">\(x_0,x_1,\cdots,x_n\)</span>是等距节点，即<span class="math">\(x_i=x_0+ih, h=\frac{b-a}{n}\)</span>。Newton插值基本公式
<div class="math">$$N_n(x)=f(x_0)+\sum^n_{k=1}f[x_0,x_1,\cdots,x_k]P_k(x)$$</div>，如果再令<span class="math">\(x=x_0+th\)</span>，可以得出
<div class="math">$$P_k(x)=\prod^{k-1}_{j=0}(x-x_j)=\prod^{k-1}_{j=0}(x_0+th-x_0-jh)=\prod^{k-1}_{j=0}(t-j)h,$$</div>
则
<div class="math">\begin{align*}
N_n(x_0+th) &amp;= f(x_0)+\sum^n_{k=1}[\frac{\Delta^k f_0}{k!h^k} \prod^{k-1}_{j=0}(t-j)h]\\
         &amp;= f(x_0)+\sum^n_{k=1}[\frac{\Delta^k f_0}{k!} \prod^{k-1}_{j=0}(t-j)]
\end{align*}</div>
余项化为<div class="math">$$R_n(x_0+th)=\frac{f^{(n+1)}(\xi)}{(n+1)!}h^{n+1}\prod^{n}_{j=0}(t-j)$$</div>
当然，我们由此Newton向前插值公式可以直接得到向后插值公式，只需要用<span class="math">\(\nabla^k f_{n}\)</span>替换<span class="math">\(\Delta^k f_0\)</span>，<span class="math">\((t-j)\)</span>换成<span class="math">\((t+j)\)</span>即可。</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </section>
    
    <aside class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "leonfocus"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </aside>
            </div>
        </section>
        
        <nav id="sidebar" class="pure-u-1 pure-u-md-1-4">
            <div class="l-box">
<section>
	<div class="portrait">
		<!-- <div class="circular"> -->
			<img src="/theme/images/leon.png" />
		<!-- </div> -->
	</div>
	<div class="name">Leon Chang, PhD candidate</div>
	<div class="sub-name">B.Sc | B.Ec @Peking University</div>
	<div class="contact"></div>
	<div class="location"></div>
</section>

<section class="tags">
    <span class="tag"><a href="/tag/physics/">#physics</a></span>
    <span class="tag"><a href="/tag/python/">#python</a></span>
    <span class="tag"><a href="/tag/scipy/">#scipy</a></span>
    <span class="tag"><a href="/tag/numerical/">#numerical</a></span>
    <span class="tag"><a href="/tag/ecomomics/">#ecomomics</a></span>
</section>
            </div>
        </nav>
        
        <footer id="footer" class="pure-u-1 pure-u-md-3-4">
            <div class="l-box">
                <div>
                    <p>&copy;2014 <a href="http://leonfocus.github.io">Leon Chang</a> &ndash;
                        Modified from Rossant's <a href="https://github.com/PurePelicanTheme/pure-single" target="_blank">Pure</a> Theme
                        for <a href="http://blog.getpelican.com/" target="_blank">Pelican</a>
                    </p>
                </div>
            </div>
        </footer>
        
    </div>
    
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=10066799; 
var sc_invisible=1; 
var sc_security="9dc1b74e"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="shopify visitor
statistics" href="http://statcounter.com/shopify/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/10066799/0/9dc1b74e/1/"
alt="shopify visitor statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>

